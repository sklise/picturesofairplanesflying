<!DOCTYPE html>
<html>
<head>
  <style>
  #wrapper {
    position: absolute;
    top: 0px;
    left: -30px;
    right: -130px;
    bottom: -30px;
  }

  #hidden {
    visibility: hidden;
  }

  #overtop {
    position: absolute;
    left: 25%;
  }

  img {
    margin: 0;
    padding: 0;
  }
  .small {
    display: block;
    float: left;
    margin: 0;
    padding: 0;
  }
  </style>

  <script type="text/javascript" src="/js/jquery.2.0.0.js"></script>
  <script type="text/javascript" src="/js/underscore.js"></script>
  <script type="text/javascript" src="/js/backbone.js"></script>
  <script>
  $(function () {
    window.airplanes = [];

    var windowSize = {
      width: $(window).width(),
      height: $(window).height()
    };

    var photoSize = {
      width: 180,
      height: 120
    };

    var fit = Math.ceil((windowSize.width * windowSize.height) / (photoSize.width * photoSize.height));


    var insertImages = function () {
        var randomized = _.sortBy(airplanes, function (item) {
          return Math.random();
        });

        _.each(randomized, function (image) {
          $('#wrapper').append('<img style="width:' + photoSize.width + 'px;height:' + photoSize.height + 'px;" data-large="' + image.large+ '" class="small" src="'+ image.small + '"/>');
        });
      }

    $.get('/photos.json').done(function(images) {
      var imagesLength = images.length
      _.each(images, function (image, index) {
        var small = "/airplanes/small/"+image;
        var medium = "/airplanes/medium/"+image;
        var large = "/airplanes/large/"+image;

        airplanes.push({
          "small": small,
          "medium" : medium,
          "large": large
        });

        $('#hidden').append("<img src='" + medium + "'>")

        if (index === imagesLength - 1 ) { insertImages(); }
      });
    });

    $(window).keydown(function () {
      if ($('#overtop').html() === '') {
        var choice = airplanes[_.random(0, airplanes.length)];
        $('#overtop').css('top', (windowSize.height/2 - 600) + 'px')
          .css('left', (windowSize.width/2 - 600) + 'px');
        $('#overtop').html("<img src='" + choice.medium + "'>");
      }
    });

    $(window).keyup(function () {
      $('#overtop').empty();
    })
  });
  </script>
</head>
<body>
  <div id="wrapper"></div>
  <div id="overtop"></div>
  <div id="hidden"></div>
</body>
</html>